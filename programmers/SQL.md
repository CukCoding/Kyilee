# SQL

## SELECT

### 문자열 역순 정렬  - DESC

---

**SELECT** NAME, DATETIME **FROM** ANIMAL_INS **ORDER BY** ANIMAL_ID **DESC**;

**SELECT** ANIMAL_ID, NAME, DATETIME **FROM** ANIMAL_INS **ORDER** **BY** NAME (**ASC)**, DATETIME **DESC**;

> 정렬 2개일 때



### 조건 - WHERE

---

**SELECT** ANIMAL_ID, NAME **FROM** ANIMAL_INS **WHERE** INTAKE_CONDITION="Sick" **ORDER** **BY** ANIMAL_ID;

> id 순이라고 해서 (기본 ASC)

**SELECT** ANIMAL_ID, NAME **FROM** ANIMAL_INS **WHERE** **NOT** INTAKE_CONDITION="Aged" **ORDER** **BY** ANIMAL_ID;

### 상위 1개 뽑기(MAX, LIMIT)

---

**SELECT** NAME **FROM** ANIMAL_INS **ORDER** **BY** DATETIME **LIMIT** 1;

> (비교기준이 select에 없을때)

**SELECT** DATETIME **AS** "시간" **FROM** ANIMAL_INS **ORDER** **BY** DATETIME DESC **LIMIT** 1;

**SELECT** **MAX**(DATETIME) FROM ANIMAL_INS ;

>(비교기준이 select에 있을 때 = **둘다가능**)

**SELECT** **MIN**(DATETIME) AS "시간" **FROM** ANIMAL_INS;

### 갯수세기

---

**SELECT** **COUNT**(ANIMAL_ID) **AS** 'count' **FROM** ANIMAL_INS;

> 문자 쓸 때는 “” ‘’ 상관없음
> 

**SELECT** **COUNT**(**DISTINCT** NAME) AS "count" FROM ANIMAL_INS **WHERE** NAME **IS NOT NULL** ;

> DISTINCT 는 열 이름 바로 앞에!
> 
> 
> IS NOT NULL은 WHERE 절에
> - null 이 있는 열에 WHERE 조건 넣어주기
> 

### GROUP BY

---

**SELECT** ANIMAL_TYPE, **COUNT**(ANIMAL_TYPE) **AS** "count" **FROM** ANIMAL_INS **GROUP** **BY** ANIMAL_TYPE **ORDER** **BY** ANIMAL_TYPE;

*나온 조건들 명시하기 (이미 오름차순이어도 order by 조건 넣어주기)

### +HAVING (GROUP BY 에 조건 붙일 때!)

---

**SELECT** NAME, **COUNT**(NAME) **AS** "COUNT" **FROM** ANIMAL_INS **GROUP** **BY** NAME **HAVING** COUNT(NAME) >1 **ORDER** **BY** NAME;

> ≥2 나 >1 이나 같음



---

---

---

> 시간에는 HOUR(DATETIME)
> 

**SELECT** HOUR(DATETIME) HOUR, COUNT(DATETIME) AS "COUNT"
**FROM** ANIMAL_OUTS
**GROUP** **BY** HOUR(DATETIME)
**HAVING** HOUR >= 9
**AND** HOUR <= 19
**ORDER** BY HOUR;

> 입양 시각 구하기(2)
> 

**SET** @HOUR = -1; // 변수 설정
**SELECT** (@HOUR := @HOUR +1) **AS** "HOUR",

(
**SELECT** COUNT(HOUR(DATETIME))
**FROM** ANIMAL_OUTS
**WHERE** HOUR(DATETIME) = @HOUR
) **AS** “COUNT”

**FROM** ANIMAL_OUTS
**WHERE** @HOUR <23; //HOUR <24로 하면 24도 출력되던데?

### IS NULL

---

**SELECT** ANIMAL_ID 
**FROM** ANIMAL_INS
**WHERE** NAME **IS NULL**
**ORDER BY** ANIMAL_ID

**SELECT** ANIMAL_ID
**FROM** ANIMAL_INS
**WHERE** NAME **IS NOT NULL**
**ORDER** **BY** ANIMAL_ID

**SELECT** ANIMAL_TYPE, **IFNULL**( NAME,"No name") **AS** NAME, SEX_UPON_INTAKE
**FROM** ANIMAL_INS
**ORDER** **BY** ANIMAL_ID

> 값이 NULL 일때 처리방법
> 

### JOIN

---

**SELECT** **OUTS**.ANIMAL_ID , **OUTS**.NAME
**FROM** ANIMAL_OUTS **OUTS**

**LEFT** **JOIN** ANIMAL_INS **INS**
**ON** OUTS.ANIMAL_ID = INS.ANIMAL_ID

**WHERE** INS.ANIMAL_ID **IS NULL**;

> ON = 두 테이블 연결
WHERE = 조건
> 

> A를 INS로, B를 OUTS로 할 때
> 

SELECT OUTS.ANIMAL_ID , [OUTS.NAME](http://outs.name/)
FROM ANIMAL_INS INS
RIGHT JOIN ANIMAL_OUTS OUTS
ON OUTS.ANIMAL_ID = INS.ANIMAL_ID
WHERE INS.ANIMAL_ID IS NULL;

<확인코드>

**SELECT** OUTS.ANIMAL_ID, [OUTS.NAME](http://OUTS.NAME),
INS.DATETIME AS "보호시작일", OUTS.DATETIME as "입양일"
**FROM** ANIMAL_OUTS OUTS

**JOIN** ANIMAL_INS INS
**ON** OUTS.ANIMAL_ID=INS.ANIMAL_ID

**WHERE** INS.DATETIME > OUTS.DATETIME
**ORDER** **BY** INS.DATETIME

> 보호시작일이 빠른 순
> 

<정답코드>

**SELECT** OUTS.ANIMAL_ID, [OUTS.NAME](http://outs.name/)
**FROM** ANIMAL_OUTS OUTS
JOIN ANIMAL_INS INS
**ON** OUTS.ANIMAL_ID = INS.ANIMAL_ID
**WHERE** INS.DATETIME > OUTS.DATETIME
**ORDER** **BY** INS.DATETIME

**SELECT** [INS.NAME](http://ins.name/), INS.DATETIME
**FROM** ANIMAL_INS INS

**LEFT** **JOIN** ANIMAL_OUTS OUTS
**ON** OUTS.ANIMAL_ID = INS.ANIMAL_ID

**WHERE** OUTS.ANIMAL_ID **IS NULL**
**ORDER** **BY** INS.DATETIME
**LIMIT** 3

**SELECT** INS.ANIMAL_ID, INS.ANIMAL_TYPE, [INS.NAME](http://ins.name/)
**FROM** ANIMAL_INS INS
**JOIN** ANIMAL_OUTS OUTS
**ON** INS.ANIMAL_ID=OUTS.ANIMAL_ID
**WHERE** INS.SEX_UPON_INTAKE != OUTS.SEX_UPON_OUTCOME
**ORDER** **BY** INS.ANIMAL_ID

### String, Date

---

SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE
FROM ANIMAL_INS
WHERE NAME= "Ella" or NAME= "Lucy" or NAME= "Pickle" or NAME= "Rogan" or NAME= "Sabrina" or NAME= "Mitty"
ORDER BY ANIMAL_ID

<같은거>

SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE
FROM ANIMAL_INS
WHERE NAME IN ("Lucy", "Ella", "Pickle", "Rogan", "Sabrina", "Mitty")

SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE NAME LIKE "%el%"
AND ANIMAL_TYPE = "Dog"
ORDER BY NAME

> 중성화 여부 판단하기
> 

SELECT ANIMAL_ID, NAME,
IF (SEX_UPON_INTAKE LIKE "%Neutered%" OR
SEX_UPON_INTAKE LIKE "%Spayed%","O","X") AS "중성화"
FROM ANIMAL_INS
ORDER BY ANIMAL_ID

<case 버전>

SELECT ANIMAL_ID, NAME,
CASE WHEN (SEX_UPON_INTAKE LIKE "%Neutered%" OR
SEX_UPON_INTAKE LIKE "%Spayed%")
THEN "O"
ELSE "X"
END
AS "중성화"
FROM ANIMAL_INS
ORDER BY ANIMAL_ID

SELECT OUTS.ANIMAL_ID, [OUTS.NAME](http://outs.name/)
FROM ANIMAL_INS INS
LEFT JOIN ANIMAL_OUTS OUTS
ON OUTS.ANIMAL_ID=INS.ANIMAL_ID
ORDER BY OUTS.DATETIME-INS.DATETIME DESC
LIMIT 2

SELECT ANIMAL_ID, NAME, DATE_FORMAT(DATETIME,"%Y-%m-%d")  AS "날짜"
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
